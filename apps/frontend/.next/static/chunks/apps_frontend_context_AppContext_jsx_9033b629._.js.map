{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ihanl/OneDrive/Desktop/Parttime-work/Ekaloka/apps/frontend/context/AppContext.jsx"],"sourcesContent":["\"use client\";\r\nimport axios from \"axios\";\r\nimport { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\n\r\nexport const AppContext = createContext();\r\n\r\nexport const useAppContext = () => {\r\n    return useContext(AppContext)\r\n}\r\n\r\nexport const AppContextProvider = (props) => {\r\n    const router = useRouter();\r\n    const url = \"http://localhost:4000\"\r\n    const [products, setProducts] = useState([])\r\n    const [cartItems, setCartItems] = useState({})\r\n    const [token, setToken] = useState(\"\");\r\n    const [isSeller, setIsSeller] = useState(false); // Placeholder for seller logic\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    const fetchProductList = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const response = await axios.get(`${url}/api/product/list`);\r\n            if (response.data.success) {\r\n                setProducts(response.data.data)\r\n            }\r\n        } catch (error) {\r\n            console.error(\"Failed to fetch product list:\", error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    const loginUser = async (userData) => {\r\n        try {\r\n            const response = await axios.post(`${url}/api/user/login`, userData);\r\n            if (response.data.success) {\r\n                setToken(response.data.token);\r\n                localStorage.setItem(\"token\", response.data.token);\r\n                // You might want to fetch user details here to set isSeller\r\n                return { success: true, message: \"Login successful!\" };\r\n            } else {\r\n                return { success: false, message: response.data.message };\r\n            }\r\n        } catch (error) {\r\n            return { success: false, message: error.response?.data?.message || \"An error occurred\" };\r\n        }\r\n    };\r\n\r\n    const registerUser = async (userData) => {\r\n        try {\r\n            const response = await axios.post(`${url}/api/user/register`, userData);\r\n            if (response.data.success) {\r\n                return { success: true, message: \"Registration successful! Please log in.\" };\r\n            } else {\r\n                return { success: false, message: response.data.message };\r\n            }\r\n        } catch (error) {\r\n            return { success: false, message: error.response?.data?.message || \"An error occurred\" };\r\n        }\r\n    };\r\n\r\n\r\n\r\n    const addToCart = (itemId) => {\r\n        if (!cartItems[itemId]) {\r\n            setCartItems((prev) => ({ ...prev, [itemId]: 1 }))\r\n        }\r\n        else {\r\n            setCartItems((prev) => ({ ...prev, [itemId]: prev[itemId] + 1 }))\r\n        }\r\n    }\r\n\r\n    const removeFromCart = (itemId) => {\r\n        setCartItems((prev) => ({ ...prev, [itemId]: prev[itemId] - 1 }))\r\n    }\r\n\r\n    const getTotalCartAmount = () => {\r\n        let totalAmount = 0;\r\n        for (const item in cartItems) {\r\n            if (cartItems[item] > 0) {\r\n                let itemInfo = products.find((product) => product._id === item);\r\n                totalAmount += itemInfo.price * cartItems[item];\r\n            }\r\n        }\r\n        return totalAmount;\r\n    }\r\n\r\n    useEffect(() => {\r\n        async function loadData() {\r\n            await fetchProductList();\r\n            if (localStorage.getItem(\"token\")) {\r\n                setToken(localStorage.getItem(\"token\"));\r\n                // Here you could also fetch user data to check role\r\n            }\r\n        }\r\n        loadData();\r\n    }, [])\r\n\r\n    const contextValue = {\r\n        products,\r\n        cartItems,\r\n        setCartItems,\r\n        addToCart,\r\n        removeFromCart,\r\n        getTotalCartAmount,\r\n        url,\r\n        router,\r\n        token,\r\n        setToken,\r\n        isSeller,\r\n        loginUser,\r\n        registerUser,\r\n        loading\r\n    }\r\n\r\n    return (\r\n        <AppContext.Provider value={contextValue}>\r\n            {props.children}\r\n        </AppContext.Provider>\r\n    )\r\n\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}